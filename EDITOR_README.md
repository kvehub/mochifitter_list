# もちふぃった～ プロファイルエディタ

profiles.jsonを簡単に編集できるGUIツール

## 2つの使い方

### A. 実行ファイル版（Python不要・推奨）

**対応OS:**
- Windows 10/11

**ダウンロードと配置:**
1. [Releases](https://github.com/eringiriri/mochifitter_list/releases) から最新版(`MochiFitterProfileEditor.exe`)をダウンロード
2. リポジトリのルートディレクトリに実行ファイルを配置

**ファイル配置:**
```
プロジェクトフォルダ/
├── MochiFitterProfileEditor.exe  (実行ファイル)
├── config.json                    (設定ファイル)
└── data/
    └── profiles.json              (データファイル)
```

3. 実行ファイルをダブルクリックで起動

### B. Python版（開発者向け）

**必要な環境:**
- Python 3.6以降
- tkinter（通常はPythonに標準で含まれている）
- tkcalendar（カレンダー機能用）

**ライブラリのインストール:**

```bash
pip install tkcalendar Pillow
```

**起動方法:**

```bash
python profile_editor.py
```

## セットアップ

### GitHub Personal Access Token (PAT) の設定

自動デプロイ機能を使用するには、GitHubトークンを設定ファイルに保存する必要があります。

#### 1. GitHubでトークンを作成

1. GitHub にログイン
2. Settings → Developer settings → Personal access tokens → Tokens (classic)
3. "Generate new token (classic)" をクリック
4. Note（名前）に "mochifitter_editor" などと入力
5. スコープで **repo** を選択（リポジトリへのフルアクセス）
6. "Generate token" をクリック
7. 生成されたトークンをコピー（このトークンは一度しか表示されません）

#### 2. 設定ファイルの作成

1. `config.sample.json` をコピーして `config.json` にリネーム
2. `config.json` を開いて、以下のように編集:

```json
{
  "github_token": "ghp_xxxxxxxxxxxx",
  "github_repo_url": "https://github.com/eringiriri/mochifitter_list.git"
}
```

3. `github_token` に先ほど作成したトークンを貼り付け
4. ファイルを保存

**注意:**
- `config.json` は `.gitignore` に含まれているため、GitHubにプッシュされません
- トークンは絶対に他人に見せないこと

## 使い方

### 機能

#### 1. データの読み込み
- 起動時に自動的に `data/profiles.json` を読み込む
- 「再読み込み」ボタンで手動で再読み込み可能

#### 2. プロファイルの表示
- 左側のリストに全プロファイルが表示される
- リストをクリックすると、右側のフォームに詳細が表示される

#### 3. プロファイルの編集
1. 左側のリストから編集したいプロファイルを選択
2. 右側のフォームで各項目を編集
3. 「変更を適用」ボタンをクリック

#### 4. 新規プロファイルの追加
1. 「新規追加」ボタンをクリック
2. 新しいプロファイルが自動的にリストに追加される（IDは空いている最も若い番号が自動採番される）
3. フォームで各項目を入力
4. 「変更を適用」ボタンをクリック

#### 5. プロファイルの削除
1. 削除したいプロファイルを選択
2. 「削除」ボタンをクリック
3. 確認ダイアログで「はい」を選択

#### 6. データの保存と自動デプロイ
- 「保存」ボタンをクリックすると、`data/profiles.json` に変更が保存される
- 最終更新日時（lastUpdated）も自動的に更新される
- 保存後、「GitHubにプッシュしてWebサイトを更新しますか？」というダイアログが表示される
  - **「はい」を選択**: 自動的にGitHubにコミット&プッシュされ、数分後にWebサイトに反映される
  - **「いいえ」を選択**: ローカルのみに保存される（手動でGit操作が必要）

**自動デプロイの仕組み:**
1. `git add data/profiles.json` でファイルをステージング
2. `git commit` で変更をコミット（メッセージは自動生成）
3. `git push` でGitHubにプッシュ
4. GitHub Pagesが自動的にサイトを更新（通常2-3分）

**注意:**
- 自動デプロイを使用するには、`config.json` の設定が必要です（上記のセットアップを参照）
- プッシュに失敗した場合はエラーダイアログが表示されます
- GitHub Pagesの反映には数分かかる場合があります

### 便利機能

#### 日付入力の補助
- **「今日」ボタン**: クリックすると今日の日付が自動入力される
- **📅 ボタン**: カレンダーダイアログが開き、視覚的に日付を選択できる
- 登録日・更新日の両方で使用可能

#### 配布方法の素早い入力
- **配布方法**: 「Booth」ボタンでワンクリック入力
- 手入力も可能

#### 価格区分の素早い入力
- **価格区分**: 「無料」「単体有料」「アバター同梱」ボタンでワンクリック入力
- 無料の場合は価格欄を空欄にする
- 単体有料/アバター同梱の場合は価格欄に数字のみを記入（例: 500）

#### 画像プレビュー
- **画像URL入力後に「プレビュー」ボタンをクリック**: 画像のプレビューが表示される
- 最大300x300ピクセルにリサイズされて表示
- URLが正しくない場合はエラーメッセージが表示される

## フィールド一覧

| フィールド名 | 説明 |
|------------|------|
| ID | プロファイルの一意な識別子（3桁の数字）。空欄で自動採番、手動入力も可能 |
| 登録日 | プロファイルの初回登録日（YYYY-MM-DD形式） |
| 更新日 | プロファイルの最終更新日（YYYY-MM-DD形式） |
| アバター名 | アバターの名前 |
| アバターURL | アバターの販売ページなどのURL |
| プロファイルバージョン | プロファイルのバージョン番号 |
| アバター作者 | アバターの作者名 |
| アバター作者URL | アバター作者のページURL |
| プロファイル作者 | プロファイルの作成者名 |
| プロファイル作者URL | プロファイル作成者のページURL |
| 配布方法 | 配布方法（例: Booth） |
| 配布場所URL | プロファイルのダウンロード先URL |
| 画像URL | アバターのサムネイル画像URL |
| 価格区分 | 無料/単体有料/アバター同梱 のいずれか |
| 価格 | 価格（数字のみ、例: 500）。無料の場合は空欄 |
| 公式 | 公式プロファイルかどうか（チェックボックス） |
| 順方向対応 | 順方向（Template→アバター）に対応しているか（チェックボックス） |
| 逆方向対応 | 逆方向（アバター→Template）に対応しているか（チェックボックス） |

## 注意事項

- データを編集した後は必ず「変更を適用」ボタンをクリックすること
- 編集内容を保存するには「保存」ボタンをクリックすること
- 保存せずにアプリケーションを終了すると、変更は失われる
- JSONファイルは UTF-8 エンコーディングで保存される
- IDフィールド:
  - 空欄のまま「変更を適用」すると、空いている最も若い番号が自動採番される
  - 手動でIDを入力した場合、その番号が使用される（重複チェックあり）
  - 既存プロファイルのIDも変更可能
